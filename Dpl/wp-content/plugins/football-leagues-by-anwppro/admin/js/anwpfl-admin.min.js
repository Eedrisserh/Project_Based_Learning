!function(document,$){function init_ajax_search(){$('.anwp-cmb-ajax-search:not([data-ajax-search="true"])').each(function(){var $this=$(this),$list=$this.closest("div").find("ul"),field_id=$this.data("field-id"),object_type=$this.data("object-type"),query_args=$this.data("query-args");$this.attr("data-ajax-search",!0),$this.devbridgeAutocomplete({serviceUrl:ajaxurl,deferRequestBy:200,type:"POST",dataType:"json",triggerSelectOnValidInput:!1,showNoSuggestionNotice:!0,params:{action:"anwp_cmb_ajax_search_get_results",nonce:anwpflGlobals.ajaxNonce,field_id:field_id,object_type:object_type,query_args:query_args},transformResult:function(results){if(!0!==results.success)return toastr.error("Data Error"),{suggestions:[]};if($("#"+field_id+"_results li").length){var selected=[];$list.find('li input[type="hidden"]').each(function(){selected.push(Number($(this).val()))}),results.data=_.reject(results.data,function(i){return _.contains(selected,i.id)})}return{suggestions:results.data}},onSearchStart:function(){$this.next(".spinner").addClass("is-active")},onSearchComplete:function(){$this.next(".spinner").removeClass("is-active")},onSelect:function(suggestion){$this.devbridgeAutocomplete("clearCache");var field_name=$this.attr("id").replace(new RegExp("_input$"),""),multiple=Number($this.attr("data-multiple")),limit=Number($this.attr("data-limit")),sortable=$this.attr("data-sortable");1===multiple?($("#"+field_name+"_results").append("<li>"+(1==sortable?'<span class="hndl"></span>':"")+'<input type="hidden" name="'+field_name+'[]" value="'+suggestion.id+'"><a href="'+suggestion.link+'" target="_blank" class="edit-link">'+suggestion.value+'</a><a class="remover"><span class="dashicons dashicons-no"></span><span class="dashicons dashicons-dismiss"></span></a></li>'),$this.val(""),0<limit&&limit==$("#"+field_name+"_results li").length?$this.prop("disabled","disabled"):$this.focus()):$("input[name="+field_name+"]").val(suggestion.id).change()}}),1===Number($this.attr("data-sortable"))&&$("#"+field_id+"_results").sortable({handle:".hndl",placeholder:"ui-state-highlight",forcePlaceholderSize:!0})})}init_ajax_search(),$(document).on("cmb2_add_row",function(evt,$row){$row.find(".anwp-cmb-ajax-search").attr("data-ajax-search",!1),init_ajax_search()}),$(document).on("widget-updated widget-added",function(){init_ajax_search()}),$("body").on("click",".anwp-cmb-ajax-search-results a.remover",function(){$(this).parent("li").fadeOut(400,function(){var field_id=$(this).parents("ul").attr("id").replace("_results","");$("#"+field_id).removeProp("disabled"),$("#"+field_id).devbridgeAutocomplete("clearCache"),$(this).remove()})})}(document,jQuery),function($){"use strict";$(function(){if($("#anwp_map_wrapper").length){var map,marker,$longitude=$("#anwp_cmb2_map_input_longitude"),$latitude=$("#anwp_cmb2_map_input_latitude"),$btnReset=$("#anwp_cmb2_map_reset_btn"),$inputSearch=$("#anwp_cmb2_map_input_address"),initialZoom=$latitude.val()&&$longitude.val()?15:8,defaultPosition={lat:$latitude.val()?parseFloat($latitude.val()):51.556,lng:$longitude.val()?parseFloat($longitude.val()):-.279575};places({container:"#anwp_cmb2_map_input_address"}).on("change",function(e){e.suggestion.latlng&&($latitude.val(e.suggestion.latlng.lat),$longitude.val(e.suggestion.latlng.lng),marker.setPosition(e.suggestion.latlng),map.setCenter(e.suggestion.latlng),map.setZoom(17))}),$inputSearch.keypress(function(e){13===parseInt(e.keyCode,10)&&e.preventDefault()}),map=new google.maps.Map(document.getElementById("anwp_map_wrapper"),{center:defaultPosition,zoom:initialZoom}),marker=new google.maps.Marker({position:defaultPosition,draggable:!0,map:map}),google.maps.event.addListener(map,"click",function(e){marker.setPosition(e.latLng),$inputSearch.val(""),$latitude.val(e.latLng.lat()),$longitude.val(e.latLng.lng())}),google.maps.event.addListener(marker,"dragend",function(e){$latitude.val(e.latLng.lat()),$longitude.val(e.latLng.lng()),$inputSearch.val("")}),$btnReset.on("click",function(e){e.preventDefault(),$latitude.val(""),$longitude.val("")})}})}(jQuery),function($){"use strict";var repeatableGroup=$(".cmb-repeatable-group");$(".anwp_fl_cmb_select2").each(function(){$(this).select2({allowClear:!0})}),$.fn.extend({select2_sortable:function(){var select=$(this);$(select).select2();var ul=$(select).next(".select2-container").first("ul.select2-selection__rendered");ul.sortable({containment:"parent",items:"li:not(.select2-search--inline)",tolerance:"pointer",stop:function(){$($(ul).find(".select2-selection__choice").get().reverse()).each(function(){var id=$(this).data("data").id,option=select.find('option[value="'+id+'"]')[0];$(select).prepend(option)})}})}}),$(".anwp_fl_cmb_select2_multi").each(function(){$(this).select2_sortable()}),repeatableGroup.on("cmb2_add_group_row_start",function(event,instance){$(document.getElementById($(instance).data("selector"))).find(".cmb-repeatable-grouping").last().find(".anwp_fl_cmb_select2").each(function(){$(this).select2("destroy")})}),repeatableGroup.on("cmb2_add_row",function(event,newRow){$(newRow).find(".anwp_fl_cmb_select2").each(function(){$("option:selected",this).removeAttr("selected"),$(this).select2({allowClear:!0})}),$(newRow).find(".anwp_fl_cmb_select2_multi").each(function(){$("option:selected",this).removeAttr("selected"),$(this).select2_sortable()}),$(newRow).prev().find(".anwp_fl_cmb_select2").each(function(){$(this).select2({allowClear:!0})}),$(newRow).prev().find(".anwp_fl_cmb_select2_multi").each(function(){$(this).select2_sortable()})}),repeatableGroup.on("cmb2_shift_rows_start",function(event,instance){$(instance).closest(".cmb-repeatable-group").find(".anwp_fl_cmb_select2").each(function(){$(this).select2("destroy")})}),repeatableGroup.on("cmb2_shift_rows_complete",function(event,instance){var groupWrap=$(instance).closest(".cmb-repeatable-group");groupWrap.find(".anwp_fl_cmb_select2").each(function(){$(this).select2({allowClear:!0})}),groupWrap.find(".anwp_fl_cmb_select2_multi").each(function(){$(this).select2_sortable()})}),$(".cmb-add-row-button").on("click",function(event){$(document.getElementById($(event.target).data("selector"))).find(".cmb-row").last().find(".anwp_fl_cmb_select2").each(function(){$(this).select2("destroy")})}),$(".cmb-repeat-table").on("cmb2_add_row",function(event,newRow){$(newRow).prev().find(".anwp_fl_cmb_select2").each(function(){$("option:selected",this).removeAttr("selected"),$(this).select2({allowClear:!0})}),$(newRow).prev().find(".anwp_fl_cmb_select2_multi").each(function(){$("option:selected",this).removeAttr("selected"),$(this).select2_sortable()})})}(jQuery),window.AnWPFootballLeagues=window.AnWPFootballLeagues||{},function(window,document,$,plugin){"use strict";var $c={};plugin.init=function(){plugin.cache(),plugin.bindEvents()},plugin.cache=function(){$c.window=$(window),$c.body=$(document.body)},plugin.bindEvents=function(){"loading"!==document.readyState?plugin.onPageReady():document.addEventListener("DOMContentLoaded",plugin.onPageReady),$c.body.on("click","[data-anwpfl-recalculate-match-stats]",function(e){e.preventDefault();var $this=$(this);$this.data("oldText",$this.text()),jQuery.ajax({dataType:"json",method:"GET",data:{option:$this.siblings("select").val()},beforeSend:function(xhr){xhr.setRequestHeader("X-WP-Nonce",anwp.rest_nonce),$this.text("processing request ...")},url:anwp.rest_root+"anwpfl/v1/helper/recalculate-matches-stats"}).always(function(){$this.text($this.data("oldText"))}).fail(function(){toastr.error("ERROR !!!")})})},plugin.onPageReady=function(){plugin.initTooltips(),plugin.initBtnPublishClick(),plugin.initMatchListHelper(),plugin.tableInputNavigation(),plugin.initTextSearch(),plugin.initOptionTabs(),plugin.initDependentOptions(),plugin.initCompetitionCloneModaal()},plugin.initDependentOptions=function(){var $wrapper=$(".cmb2-metabox");$wrapper.on("change",".anwp-fl-parent-of-dependent",function(){var $parent=$(this);$wrapper.find('.anwp-fl-dependent-field[data-parent="'+$parent.data("name")+'"]').each(function(){var childWrapper=$(this),childDataValue=childWrapper.data("value").split(",");_.contains(childDataValue,$parent.val())&&"show"===childWrapper.data("action")||!_.contains(childDataValue,$parent.val())&&"hide"===childWrapper.data("action")?childWrapper.closest(".cmb-row").removeClass("d-none"):childWrapper.closest(".cmb-row").addClass("d-none")})}),$wrapper.find(".anwp-fl-parent-of-dependent").trigger("change")},plugin.initOptionTabs=function(){var initialTab,wrapper=$c.body.find(".anwp-metabox-tabs");if(!wrapper.length)return!1;wrapper.on("click",".anwp-metabox-tabs__control-item",function(e){e.preventDefault();var $this=$(this);if($this.hasClass("anwp-active-tab"))return!1;var target=$($this.data("target"));$this.addClass("anwp-active-tab").siblings(".anwp-metabox-tabs__control-item.anwp-active-tab").removeClass("anwp-active-tab"),target.removeClass("d-none invisible").siblings(".anwp-metabox-tabs__content-item:not( .d-none )").addClass("d-none"),$this.data("target")&&$c.body.find("#anwp_football_leagues_options_metabox").length&&(history.pushState?history.pushState({},"",$this.data("target")):window.location.hash=$this.data("target").substr(1),wrapper.find("#anwp_current_page_hash").val($this.data("target")))}),window.location.hash&&wrapper.find('.anwp-metabox-tabs__control-item[data-target="'+window.location.hash+'"]').length&&(initialTab=wrapper.find('.anwp-metabox-tabs__control-item[data-target="'+window.location.hash+'"]')),!initialTab&&wrapper.find("#anwp_current_page_hash").val()&&(initialTab=wrapper.find('.anwp-metabox-tabs__control-item[data-target="'+wrapper.find("#anwp_current_page_hash").val()+'"]')),initialTab&&initialTab.length||(initialTab=wrapper.find(".anwp-metabox-tabs__control-item:first-child")),initialTab.trigger("click")},plugin.initTextSearch=function(){var $input=$c.body.find("#anwp-fl-live-text-search");if(!$input.length)return!1;$input.on("input",function(e){e.preventDefault();var filter=$input.val().toLowerCase();return $c.body.find("#anwp_fl_text_metabox .anwp-fl-search-data").each(function(){var $this=$(this),search1=$this.data("search-origin"),search2=$this.data("search-modified");-1!==search1.indexOf(filter)||-1!==search2.indexOf(filter)?$this.closest(".cmb-type-anwp-fl-text").removeClass("d-none"):$this.closest(".cmb-type-anwp-fl-text").addClass("d-none")}),!1})},plugin.tableInputNavigation=function(){$(".anwp-fl-input-table").find("td input").keyup(function(e){39===e.which?$(this).closest("td").next().find("input").focus():37===e.which?$(this).closest("td").prev().find("input").focus():40===e.which?$(this).closest("tr").next().find("td:eq("+$(this).closest("td").index()+")").find("input").focus():38===e.which&&$(this).closest("tr").prev().find("td:eq("+$(this).closest("td").index()+")").find("input").focus()}),$(".anwp-fl-input-table").find("td input[type=number]").keydown(function(e){38!==e.which&&40!==e.which||e.preventDefault()})},plugin.initTooltips=function(){tippy("[data-anwpfl_tippy]",{arrow:!0,size:"small"})},plugin.initBtnPublishClick=function(){var btnClick=$("#anwp-publish-click-proxy"),btnPublish=$("#publish");btnClick.length&&btnClick.on("click",function(e){if(e.preventDefault(),btnClick.prop("disabled"))return!1;btnClick.prop("disabled",!0),btnClick.next(".spinner").addClass("is-active"),btnPublish.length&&btnPublish.click()})},plugin.initMatchListHelper=function(){if($c.body.find('input[name="_anwpfl_date_from"]').length&&void 0!==jQuery.datepicker){var inputFrom=$c.body.find('input[name="_anwpfl_date_from"]'),inputTo=$c.body.find('input[name="_anwpfl_date_to"]');$(inputFrom).add(inputTo).datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,beforeShow:function(input,inst){inst.dpDiv.addClass("cmb2-element")}}),inputFrom.on("change",function(){inputTo.datepicker("option","minDate",inputFrom.val())}),inputTo.on("change",function(){inputFrom.datepicker("option","maxDate",inputTo.val())})}},plugin.initCompetitionCloneModaal=function(){var cloneLink=$c.body.find(".anwp-fl-competition-clone-action"),activeData={link:!1,process:!1};$c.body.find("#anwp-fl-competition-clone-modaal").length&&cloneLink.length&&(cloneLink.modaal({content_source:"#anwp-fl-competition-clone-modaal",custom_class:"anwpfl-shortcode-modal",hide_close:!0,animation:"none"}),cloneLink.on("click",function(e){e.preventDefault(),activeData.link=$(this),activeData.link.modaal("open")}),$("#anwp-fl-competition-clone-modaal__cancel").on("click",function(e){e.preventDefault(),activeData.link.modaal("close")}),$("#anwp-fl-competition-clone-modaal__clone").on("click",function(e){if(activeData.process)return!1;activeData.process=!0,e.preventDefault();var $this=$(this);$this.next(".spinner").addClass("is-active"),$.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"fl_clone_competition",nonce:anwpflGlobals.ajaxNonce,competition_id:activeData.link.data("competition-id"),season_id:$c.body.find("#anwp-fl-clone-season-id").val()}}).done(function(response){response.success?location.href=response.data.link:location.reload(),$this.next(".spinner").removeClass("is-active")})}))},$(plugin.init)}(window,document,jQuery,window.AnWPFootballLeagues);